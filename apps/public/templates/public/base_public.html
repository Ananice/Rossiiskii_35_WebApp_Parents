{% extends "base/base.html" %}
{% load static %}

{% block title %}{{ page_title|default:"Публичный портал" }}{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- Public navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light rounded px-3 mb-3">
    <a class="navbar-brand fw-bold" href="{% url 'public:index' %}">Портал</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#publicNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="publicNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="{% url 'public:about' %}">О проекте</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:features' %}">Возможности</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:roles' %}">Роли</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:security' %}">Безопасность</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:docs' %}">Документация</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:faq' %}">FAQ</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:news' %}">Новости</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:sitemap' %}">Карта сайта</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'public:contacts' %}">Обратная связь</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'core:login' %}">Вход</a></li>
		{% if user.is_authenticated and user.role in ("admin", "employee") %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'public:staff_feedback_list' %}">Обращения (staff)</a>
          </li>
        {% endif %}
      </ul>
    </div>
  </nav>

  <!-- Breadcrumbs -->
  {% if breadcrumbs %}
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb mb-0">
      {% for label, url in breadcrumbs %}
        {% if url %}
          <li class="breadcrumb-item"><a href="{{ url }}">{{ label }}</a></li>
        {% else %}
          <li class="breadcrumb-item active" aria-current="page">{{ label }}</li>
        {% endif %}
      {% endfor %}
    </ol>
  </nav>
  {% endif %}

  <!-- Page body -->
  <div class="card shadow-sm">
    <div class="card-body">
      {% block public_content %}{% endblock %}
    </div>
  </div>

  <!-- Public footer -->
  <footer class="text-center text-muted mt-4">
    <small>
      Автор: Российский Даниил Ильич. 2025–2026.
      &nbsp;|&nbsp; <a href="{% url 'public:privacy' %}">Политика ПДн</a>
      &nbsp;|&nbsp; <a href="{% url 'public:terms' %}">Соглашение</a>
    </small>
  </footer>

</div>
{% endblock %}
